«стратегия повторных попыток» — это предпочтительный подход по сравнению с использованием пассивных задержек.

```go
func assert(t *testing.T, assertion func() bool,
	maxRetry int, waitTime time.Duration) {
	for i := 0; i < maxRetry; i++ {
		if assertion() {
			// Проверка assertion
			return
		}
		time.Sleep(waitTime) // Пауза перед повторной попыткой
	}
	t.Fail() // В итоге проваливается после нескольких попыток
}
```

Некоторые библиотеки тестирования, например testify, предлагают функции, использующие «повторные попытки». В testify есть функция Eventually, реализующая утверждения, которые в конечном итоге должны оказаться правильными, а также другие функции, например на- стройку сообщения об ошибке.

---

Что выбрать: повторы или синхронизацию (через каналы)? Синхронизация сокращает время ожидания до минимума и делает тест полностью детерминированным, если он хорошо спроектирован. Если синхронизация действительно невозможна, мы должны — для устранения не- детерминированности результатов тестов — использовать опцию «повторных попыток», которая является лучшим выбором, чем использование пассивных задержек.
